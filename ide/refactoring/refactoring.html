<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Provide rich refactoring services - UCI Bootcamp 2021: Python for Data Science</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../favicon.svg">
                        <link rel="shortcut icon" href="../../favicon.png">
                <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
                <link rel="stylesheet" href="../../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../preface.html"><strong aria-hidden="true">1.</strong> Preface</a></li><li class="chapter-item expanded "><a href="../../ide/intro/index.html"><strong aria-hidden="true">2.</strong> IDEs and you</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ide/intro/tools.html"><strong aria-hidden="true">2.1.</strong> The tools of the trade</a></li><li class="chapter-item expanded "><a href="../../ide/intro/pycharm.html"><strong aria-hidden="true">2.2.</strong> Introducing PyCharm</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.</strong> What they can do for you</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.1.</strong> Static analysis</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ide/syntax_highlighting/syntax_highlighting.html"><strong aria-hidden="true">2.3.1.1.</strong> syntax highlighting and code completion</a></li><li class="chapter-item expanded "><a href="../../ide/error_detection/error_detection.html"><strong aria-hidden="true">2.3.1.2.</strong> Programming error detection</a></li><li class="chapter-item expanded "><a href="../../ide/call_graphs/call_graphs.html"><strong aria-hidden="true">2.3.1.3.</strong> Call graphs</a></li><li class="chapter-item expanded "><a href="../../ide/refactoring/refactoring.html" class="active"><strong aria-hidden="true">2.3.1.4.</strong> Provide rich refactoring services</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.3.2.</strong> Integrate with various development tools</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../ide/run_configs/run_configurations.html"><strong aria-hidden="true">2.3.2.1.</strong> Run configurations</a></li><li class="chapter-item expanded "><a href="../../ide/breakpoints/debuggers.html"><strong aria-hidden="true">2.3.2.2.</strong> Debuggers</a></li><li class="chapter-item expanded "><a href="../../ide/vcs/vcs.html"><strong aria-hidden="true">2.3.2.3.</strong> Provide rich version control integration</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.</strong> Python</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.1.</strong> History</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.2.</strong> Applications in Data Science</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.</strong> Noteworthy distributions</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.1.</strong> CPython</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.2.</strong> Anaconda</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> A primer on syntax</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../python/hello_world.html"><strong aria-hidden="true">3.4.1.</strong> &quot;Hello world&quot;</a></li><li class="chapter-item expanded "><a href="../../python/comments.html"><strong aria-hidden="true">3.4.2.</strong> Comments and string literals</a></li><li class="chapter-item expanded "><a href="../../python/basic_math_operators.html"><strong aria-hidden="true">3.4.3.</strong> Basic math operators</a></li><li class="chapter-item expanded "><a href="../../python/variables.html"><strong aria-hidden="true">3.4.4.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../../python/booleans.html"><strong aria-hidden="true">3.4.5.</strong> Boolean operations</a></li><li class="chapter-item expanded "><a href="../../python/typing.html"><strong aria-hidden="true">3.4.6.</strong> Types</a></li><li class="chapter-item expanded "><a href="../../python/basic_containers/summary.html"><strong aria-hidden="true">3.4.7.</strong> Builtin containers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../python/basic_containers/lists.html"><strong aria-hidden="true">3.4.7.1.</strong> list</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.7.2.</strong> dict</div></li><li class="chapter-item expanded "><a href="../../python/basic_containers/sets.html"><strong aria-hidden="true">3.4.7.3.</strong> set</a></li></ol></li><li class="chapter-item expanded "><a href="../../python/loops/for.html"><strong aria-hidden="true">3.4.8.</strong> For loops</a></li><li class="chapter-item expanded "><a href="../../python/loops/while.html"><strong aria-hidden="true">3.4.9.</strong> While loops</a></li><li class="chapter-item expanded "><a href="../../python/functions.html"><strong aria-hidden="true">3.4.10.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../../python/modules.html"><strong aria-hidden="true">3.4.11.</strong> Introduction to modules</a></li><li class="chapter-item expanded "><a href="../../python/packages.html"><strong aria-hidden="true">3.4.12.</strong> Introduction to packages</a></li><li class="chapter-item expanded "><a href="../../python/import_this.html"><strong aria-hidden="true">3.4.13.</strong> import this</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../python/pathlib.html"><strong aria-hidden="true">3.4.13.1.</strong> pathlib and cross-platform file paths</a></li></ol></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Intermission</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.1.</strong> Code Style</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.2.</strong> Project Structure</div></li></ol></li><li class="chapter-item expanded "><a href="../../python/third_party_libs/summary.html"><strong aria-hidden="true">3.6.</strong> Doing data science using SciPy and other third-party libraries</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../python/ipython.html"><strong aria-hidden="true">3.6.1.</strong> IPython</a></li><li class="chapter-item expanded "><a href="../../python/the_ndarray.html"><strong aria-hidden="true">3.6.2.</strong> Numpy</a></li><li class="chapter-item expanded "><a href="../../python/jupyter_notebook.html"><strong aria-hidden="true">3.6.3.</strong> Jupyter Notebook</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../python/jupyter_notebook_pitfalls.html"><strong aria-hidden="true">3.6.3.1.</strong> Common pitfalls and their mitigations</a></li></ol></li><li class="chapter-item expanded "><a href="../../python/pandas/dataframe.html"><strong aria-hidden="true">3.6.4.</strong> Pandas and the DataFrame</a></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.4.1.</strong> Adding calculated data to dataframes</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.4.2.</strong> Basic manipulations</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.4.3.</strong> Writing datasets</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.5.</strong> SciPy</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.6.</strong> matplotlib</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.6.1.</strong> Plotting data, the manual way</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.6.2.</strong> Plotting data, via Pandas wrappers</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.7.</strong> Seaborn</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.7.1.</strong> Plotting data, via Seaborn wrappers</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.8.</strong> Poetry</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">3.6.8.1.</strong> A Primer on dependency management</div></li></ol></li></ol></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">UCI Bootcamp 2021: Python for Data Science</h1>

                    <div class="right-buttons">
                                                <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="refactoring"><a class="header" href="#refactoring">Refactoring</a></h1>
<p>As the size of code grows, so does the understanding of the developer. What may have made sense at the
start of the project may suddenly not work quite as well halfway in.</p>
<p>Sometimes functions simply need to be moved into a new module for better organization, or a repeated
operation simplified into a variable. Sometimes Entire superclasses can be extracted to better
represent the code structure.</p>
<p>These are all examples of <code>refactoring</code></p>
<blockquote>
<p>Refactor: To rewrite existing source code in order to improve its readability, reusability and/or structure, without changing the behavior of the code.</p>
</blockquote>
<p>Let's take this presentation, for example!</p>
<p>At the time of writing, the IDE documents are full of images, which are included in the rendered
documents.</p>
<p>Initially, all of the images sat at the same level as the source <code>.md</code> documents they are included in,
which are all in the same <code>src/ide</code> folder. This proved itself unwieldy, as the file structure is not
conducive to a viewer's understanding of what documents import which image files.</p>
<h2 id="renaming-and-moving-files"><a class="header" href="#renaming-and-moving-files">Renaming and moving files</a></h2>
<p>One mode of refactoring is to move files from one directory to another.</p>
<blockquote>
<p>&quot;Why does the IDE need to support this? can't you just move it in the OSes file browser?&quot;
Well no, because the files are referenced by <em>other files</em>. Moving a file without modifying its uses will break those uses.</p>
</blockquote>
<p>Pycharm supports many forms of refactoring which are valid in different contexts. In this specific
case, files can be moved via the projects window.</p>
<p>From the context menu (right-click on the file), select refactor&gt;move</p>
<ul>
<li>PyCharm will automatically update all references to the file to point to the new location.</li>
</ul>
<h2 id="renaming-functions-in-code"><a class="header" href="#renaming-functions-in-code">Renaming functions in code</a></h2>
<p>Renaming and moving files is one thing, but its hardly impressive. Let's do something a bit more
involved: renaming a <a href="../../python/functions.html">function!</a></p>
<p>Once more we call back to the <a href="../../python/pathlib.html">Pathlib example</a></p>
<p>If we recall the source code of this example, we will see there is a function defined here!.</p>
<pre><code class="language-python"># uci_bootcamp_2021/examples/pathlib_example.py
# Brings the module `pathlib` into scope.
import pathlib


# define a function called `main`, which contains the example code.
def main():
    # Create a pythonic pointer to the data file ./data/us-graph-2015-02.csv
    # &lt;repository_root&gt;/data/us-graph-2015-02.csv
    target = pathlib.Path() / &quot;data&quot; / &quot;us-graph-2015-02.csv&quot;

    # read the lines out of the data file
    lines = target.read_text().splitlines()
    # emit the first line of the data
    print(lines[0])

</code></pre>
<p>If we recall from
the <a href="../call_graphs/call_graphs.html#getting-a-list-of-everything-that-calls-this-function">Call Graphs</a>
section, an entirely different module calls this function!</p>
<p>If we were to rename this function <em>without</em> refactoring; the test suite will fail.</p>
<p>Fun fact: Pycharm is smart enough to ask you if you want to refactor if you manually edit a function
name!
<img src="01.png" alt="img.png" /></p>
<p>Anyways, if we ignored this warning for the sake of demonstration we can observe the <a href="">test suite</a>
failing.
<img src="02.png" alt="img.png" /></p>
<ul>
<li>This demonstrates that renaming things requires a bit more effort than changing the definition.</li>
</ul>
<p>However, if we used the <code>refactor | rename</code> feature, all of the usages will be updated and the tests
will pass.</p>
<h2 id="extracting-variables"><a class="header" href="#extracting-variables">Extracting variables</a></h2>
<p>The last of the major refactoring features that we will show here is the <code>Refactor | Extract Variable</code></p>
<p>Take the following code fragment for example:</p>
<pre><code class="language-python">x = 4 + (16 ** 32 - 4 % 7)
y = x + (16 ** 32 - 4 % 7)
z = y + (16 ** 32 - 4 % 7)
</code></pre>
<p>In this poorly written example, each of the three lines repeats a comparatively expensive operation
needlessly.</p>
<p>To make this code simpler, we can do one of two things:</p>
<ol>
<li>Manually introduce a variable and update all three lines of code to use that variable</li>
<li>Or we can ask PyCharm to do it for us via the <code>Refactor | Extract Variable feature.</code>
<img src="03.png" alt="img.png" /></li>
</ol>
<pre><code class="language-python">expensive = (16 ** 32 - 4 % 7)
x = 4 + expensive
y = x + expensive
z = y + expensive
</code></pre>
<h1 id="further-reading"><a class="header" href="#further-reading">Further reading:</a></h1>
<p>There are other refactoring capabilities that IDEs can offer.
<a href="https://www.jetbrains.com/help/pycharm/move-refactorings.html">Move Refactorings official docs</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../../ide/call_graphs/call_graphs.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../../ide/run_configs/run_configurations.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../../ide/call_graphs/call_graphs.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../../ide/run_configs/run_configurations.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
